<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IBAMR: IBAMR::LevelSetUtilities Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IBAMR
   </div>
   <div id="projectbrief">An adaptive and distributed-memory parallel implementation of the immersed boundary (IB) method</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_i_b_a_m_r.html">IBAMR</a></li><li class="navelem"><a class="el" href="namespace_i_b_a_m_r_1_1_level_set_utilities.html">LevelSetUtilities</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">IBAMR::LevelSetUtilities Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class <a class="el" href="namespace_i_b_a_m_r_1_1_level_set_utilities.html" title="Class LevelSetUtilities provides implementation of some helper functions to enforce mass/volume conse...">LevelSetUtilities</a> provides implementation of some helper functions to enforce mass/volume conservation of phases.  
<a href="namespace_i_b_a_m_r_1_1_level_set_utilities.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_level_set_container.html">LevelSetContainer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A lightweight class to hold the level set variable and the associated hierarchy integrator (<a class="el" href="class_i_b_a_m_r_1_1_adv_diff_hierarchy_integrator.html" title="Class AdvDiffHierarchyIntegrator provides an abstract interface for a time integrator for advection-d...">AdvDiffHierarchyIntegrator</a>).  <a href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_level_set_container.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_tag_l_s_refinement_cells.html">TagLSRefinementCells</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A lightweight class to tag grid cells containing the level set variable for grid refinement.  <a href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_tag_l_s_refinement_cells.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_level_set_mass_loss_fixer.html">LevelSetMassLossFixer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A lightweight class that stores the current value of the Lagrange multiplier for the level set variable.  <a href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_level_set_mass_loss_fixer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_set_l_s_properties.html">SetLSProperties</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class <a class="el" href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_set_l_s_properties.html" title="Class SetLSProperties is a utility class which sets (or resets after reinitialization) level set valu...">SetLSProperties</a> is a utility class which sets (or resets after reinitialization) level set values on the patch hierarchy.  <a href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_set_l_s_properties.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abfe87c05511a1a7056d4738ecb263a64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_i_b_a_m_r_1_1_level_set_utilities.html#abfe87c05511a1a7056d4738ecb263a64">tagLSCells</a> (<a class="elRef" href="../../samrai/2.4.4/html/classSAMRAI_1_1tbox_1_1Pointer.html">SAMRAI::tbox::Pointer</a>&lt; <a class="elRef" href="../../samrai/2.4.4/html/classSAMRAI_1_1hier_1_1BasePatchHierarchy.html">SAMRAI::hier::BasePatchHierarchy</a>&lt; NDIM &gt; &gt; hierarchy, const int level_number, const double error_data_time, const int tag_index, const bool initial_time, const bool uses_richardson_extrapolation_too, void *ctx)</td></tr>
<tr class="memdesc:abfe87c05511a1a7056d4738ecb263a64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Preprocessing call back function to be hooked into IBAMR::HierarchyIntegrator class to tag the cells for grid refinement based on the given tagging criteria.  <a href="namespace_i_b_a_m_r_1_1_level_set_utilities.html#abfe87c05511a1a7056d4738ecb263a64">More...</a><br /></td></tr>
<tr class="separator:abfe87c05511a1a7056d4738ecb263a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ac96b4221b9fe055bb82a8c69607d24"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_i_b_a_m_r_1_1_level_set_utilities.html#a3ac96b4221b9fe055bb82a8c69607d24">fixMassLoss2PhaseFlows</a> (double current_time, double new_time, bool skip_synchronize_new_state_data, int num_cycles, void *ctx)</td></tr>
<tr class="memdesc:a3ac96b4221b9fe055bb82a8c69607d24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the value of the Lagrange multiplier <img class="formulaInl" alt="$ q $" src="form_18.png"/> and use that to adjust the flow level set variable <img class="formulaInl" alt="$ \tilde{\phi} $" src="form_153.png"/> to satisfy the constraint: <img class="formulaInl" alt="$ f(q) = \int_{\Omega} H(\tilde{\phi} + q) \text{d}\Omega - V^0 = 0 $" src="form_154.png"/>. where, <img class="formulaInl" alt="$ \tilde{\phi} $" src="form_153.png"/> is the level set field obtained from the reinitialization procedure, <img class="formulaInl" alt="$ V^0 $" src="form_155.png"/> is the volume of the fluid at <img class="formulaInl" alt="$ t = 0 $" src="form_139.png"/> s which needs to be conserved. Here, <img class="formulaInl" alt="$ q $" src="form_18.png"/> is computed using the Newton's method till required tolerance. In practice the level set mass loss would be fixed during the postprocess integrate hierarchy stage. Hence the application time would be the new time and the variable context would be the new context.  <a href="namespace_i_b_a_m_r_1_1_level_set_utilities.html#a3ac96b4221b9fe055bb82a8c69607d24">More...</a><br /></td></tr>
<tr class="separator:a3ac96b4221b9fe055bb82a8c69607d24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5443ccbebe0c5ffe018fd58a6ad25c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_i_b_a_m_r_1_1_level_set_utilities.html#ad5443ccbebe0c5ffe018fd58a6ad25c2">fixMassLoss3PhaseFlows</a> (double current_time, double new_time, bool skip_synchronize_new_state_data, int num_cycles, void *ctx)</td></tr>
<tr class="memdesc:ad5443ccbebe0c5ffe018fd58a6ad25c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the value of the Lagrange multiplier <img class="formulaInl" alt="$ q $" src="form_18.png"/> and use that to adjust the flow level set <img class="formulaInl" alt="$ \tilde{\phi $" src="form_156.png"/> when there is a solid phase in the domain with level set <img class="formulaInl" alt="$ \psi &lt; 0 $" src="form_157.png"/>. Satisfies the constraint: <img class="formulaInl" alt="$ f(q) = \int_{\Omega} H(\tilde{\phi} + q) H(\psi) \text{d}\Omega - V^0 = 0 $" src="form_158.png"/>. where, <img class="formulaInl" alt="$ \tilde{\phi} $" src="form_153.png"/> is the level set field obtained from the reinitialization procedure, <img class="formulaInl" alt="$ V^0 $" src="form_155.png"/> is the volume of the fluid at <img class="formulaInl" alt="$ t = 0 $" src="form_139.png"/> s which needs to be conserved. Here, <img class="formulaInl" alt="$ q $" src="form_18.png"/> is computed using the Newton's method till required tolerance. In practice the level set mass loss would be fixed during the postprocess integrate hierarchy stage. Hence the application time would be the new time and the variable context would be the new context.  <a href="namespace_i_b_a_m_r_1_1_level_set_utilities.html#ad5443ccbebe0c5ffe018fd58a6ad25c2">More...</a><br /></td></tr>
<tr class="separator:ad5443ccbebe0c5ffe018fd58a6ad25c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2734ab03aa2ea22f861a86ceae784dba"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a08551.html">std::vector</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_i_b_a_m_r_1_1_level_set_utilities.html#a2734ab03aa2ea22f861a86ceae784dba">computeHeavisideIntegrals2PhaseFlows</a> (const <a class="el" href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_level_set_container.html">LevelSetContainer</a> &amp;lsc)</td></tr>
<tr class="separator:a2734ab03aa2ea22f861a86ceae784dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84c8ad72cf8c2086ec2254c35eedeec8"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a08551.html">std::vector</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_i_b_a_m_r_1_1_level_set_utilities.html#a84c8ad72cf8c2086ec2254c35eedeec8">computeHeavisideIntegrals3PhaseFlows</a> (const <a class="el" href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_level_set_container.html">LevelSetContainer</a> &amp;lsc)</td></tr>
<tr class="separator:a84c8ad72cf8c2086ec2254c35eedeec8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad08a80ca1de2ee3df796bdc93a656a9b"><td class="memItemLeft" align="right" valign="top"><a id="ad08a80ca1de2ee3df796bdc93a656a9b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_i_b_a_m_r_1_1_level_set_utilities.html#ad08a80ca1de2ee3df796bdc93a656a9b">setLSDataPatchHierarchy</a> (int ls_idx, <a class="elRef" href="../../samrai/2.4.4/html/classSAMRAI_1_1tbox_1_1Pointer.html">SAMRAI::tbox::Pointer</a>&lt; <a class="el" href="class_i_b_t_k_1_1_hierarchy_math_ops.html">IBTK::HierarchyMathOps</a> &gt; hier_math_ops, const int integrator_step, const double current_time, const bool initial_time, const bool regrid_time, void *ctx)</td></tr>
<tr class="memdesc:ad08a80ca1de2ee3df796bdc93a656a9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function that sets or resets the level set data on the patch hierarchy. <br /></td></tr>
<tr class="separator:ad08a80ca1de2ee3df796bdc93a656a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class <a class="el" href="namespace_i_b_a_m_r_1_1_level_set_utilities.html" title="Class LevelSetUtilities provides implementation of some helper functions to enforce mass/volume conse...">LevelSetUtilities</a> provides implementation of some helper functions to enforce mass/volume conservation of phases. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a2734ab03aa2ea22f861a86ceae784dba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2734ab03aa2ea22f861a86ceae784dba">&#9670;&nbsp;</a></span>computeHeavisideIntegrals2PhaseFlows()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a08551.html">std::vector</a>&lt; double &gt; IBAMR::LevelSetUtilities::computeHeavisideIntegrals2PhaseFlows </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_level_set_container.html">LevelSetContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>lsc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>Integrals of <img class="formulaInl" alt="$ 1- H(\phi)$" src="form_159.png"/>, <img class="formulaInl" alt="$ H(\phi)$" src="form_160.png"/>, and <img class="formulaInl" alt="$ \delta(\phi) $" src="form_161.png"/> over the entire domain.</dd></dl>
<p>Here, <img class="formulaInl" alt="$ H(\phi) $" src="form_162.png"/> is the Heaviside function demarcating liquid and gas domains.</p>
<p><img class="formulaInl" alt="$ \phi $" src="form_86.png"/> is taken to be positive in the liquid domain and negative in the gas domain.</p>
<p>Physically, these three integrals represent volume of the gas region, liquid region, and surface area of the interface, respectively. </p>

</div>
</div>
<a id="a84c8ad72cf8c2086ec2254c35eedeec8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84c8ad72cf8c2086ec2254c35eedeec8">&#9670;&nbsp;</a></span>computeHeavisideIntegrals3PhaseFlows()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a08551.html">std::vector</a>&lt; double &gt; IBAMR::LevelSetUtilities::computeHeavisideIntegrals3PhaseFlows </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_level_set_container.html">LevelSetContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>lsc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>Integrals of <img class="formulaInl" alt="$ [1- H(\phi)] H(\Psi) $" src="form_163.png"/>, <img class="formulaInl" alt="$ H(\phi) H(\Psi)$" src="form_164.png"/>, <img class="formulaInl" alt="$ 1 - H(\Psi)$" src="form_165.png"/>, and <img class="formulaInl" alt="$ \delta(\phi)H(\Psi)$" src="form_166.png"/> over the entire domain.</dd></dl>
<p>Here, <img class="formulaInl" alt="$ H(\phi) $" src="form_162.png"/> is the Heaviside function demarcating liquid and gas domains, and <img class="formulaInl" alt="$ H(\Psi) $" src="form_167.png"/> is the Heaviside function demarcating solid and fluid (fluid = liquid and gas) domains.</p>
<p>Physically, these four integrals represents volume of the gas region, liquid region, solid region, and surface area of the fluid interface, respectively.</p>
<p><img class="formulaInl" alt="$ \phi $" src="form_86.png"/> is taken to be positive in the liquid domain and negative in the gas domain.</p>
<p><img class="formulaInl" alt="$ \Psi $" src="form_168.png"/> is taken to be positive outside the solid and negative inside the solid. </p>

</div>
</div>
<a id="a3ac96b4221b9fe055bb82a8c69607d24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ac96b4221b9fe055bb82a8c69607d24">&#9670;&nbsp;</a></span>fixMassLoss2PhaseFlows()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IBAMR::LevelSetUtilities::fixMassLoss2PhaseFlows </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>current_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>new_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>skip_synchronize_new_state_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_cycles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the value of the Lagrange multiplier <img class="formulaInl" alt="$ q $" src="form_18.png"/> and use that to adjust the flow level set variable <img class="formulaInl" alt="$ \tilde{\phi} $" src="form_153.png"/> to satisfy the constraint: <img class="formulaInl" alt="$ f(q) = \int_{\Omega} H(\tilde{\phi} + q) \text{d}\Omega - V^0 = 0 $" src="form_154.png"/>. where, <img class="formulaInl" alt="$ \tilde{\phi} $" src="form_153.png"/> is the level set field obtained from the reinitialization procedure, <img class="formulaInl" alt="$ V^0 $" src="form_155.png"/> is the volume of the fluid at <img class="formulaInl" alt="$ t = 0 $" src="form_139.png"/> s which needs to be conserved. Here, <img class="formulaInl" alt="$ q $" src="form_18.png"/> is computed using the Newton's method till required tolerance. In practice the level set mass loss would be fixed during the postprocess integrate hierarchy stage. Hence the application time would be the new time and the variable context would be the new context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>is the pointer to the <a class="el" href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_level_set_mass_loss_fixer.html" title="A lightweight class that stores the current value of the Lagrange multiplier for the level set variab...">LevelSetMassLossFixer</a> class object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad5443ccbebe0c5ffe018fd58a6ad25c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5443ccbebe0c5ffe018fd58a6ad25c2">&#9670;&nbsp;</a></span>fixMassLoss3PhaseFlows()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IBAMR::LevelSetUtilities::fixMassLoss3PhaseFlows </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>current_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>new_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>skip_synchronize_new_state_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_cycles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the value of the Lagrange multiplier <img class="formulaInl" alt="$ q $" src="form_18.png"/> and use that to adjust the flow level set <img class="formulaInl" alt="$ \tilde{\phi $" src="form_156.png"/> when there is a solid phase in the domain with level set <img class="formulaInl" alt="$ \psi &lt; 0 $" src="form_157.png"/>. Satisfies the constraint: <img class="formulaInl" alt="$ f(q) = \int_{\Omega} H(\tilde{\phi} + q) H(\psi) \text{d}\Omega - V^0 = 0 $" src="form_158.png"/>. where, <img class="formulaInl" alt="$ \tilde{\phi} $" src="form_153.png"/> is the level set field obtained from the reinitialization procedure, <img class="formulaInl" alt="$ V^0 $" src="form_155.png"/> is the volume of the fluid at <img class="formulaInl" alt="$ t = 0 $" src="form_139.png"/> s which needs to be conserved. Here, <img class="formulaInl" alt="$ q $" src="form_18.png"/> is computed using the Newton's method till required tolerance. In practice the level set mass loss would be fixed during the postprocess integrate hierarchy stage. Hence the application time would be the new time and the variable context would be the new context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>is the pointer to the <a class="el" href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_level_set_mass_loss_fixer.html" title="A lightweight class that stores the current value of the Lagrange multiplier for the level set variab...">LevelSetMassLossFixer</a> class object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abfe87c05511a1a7056d4738ecb263a64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfe87c05511a1a7056d4738ecb263a64">&#9670;&nbsp;</a></span>tagLSCells()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IBAMR::LevelSetUtilities::tagLSCells </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="../../samrai/2.4.4/html/classSAMRAI_1_1tbox_1_1Pointer.html">SAMRAI::tbox::Pointer</a>&lt; <a class="elRef" href="../../samrai/2.4.4/html/classSAMRAI_1_1hier_1_1BasePatchHierarchy.html">SAMRAI::hier::BasePatchHierarchy</a>&lt; NDIM &gt; &gt;&#160;</td>
          <td class="paramname"><em>hierarchy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>level_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>error_data_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tag_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>initial_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>uses_richardson_extrapolation_too</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Preprocessing call back function to be hooked into IBAMR::HierarchyIntegrator class to tag the cells for grid refinement based on the given tagging criteria. </p>
<p>This static member should be registered with an appropriate hierarchy integrator via registerApplyGradientDetectorCallback().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>is the pointer to the <a class="el" href="class_i_b_a_m_r_1_1_level_set_utilities_1_1_tag_l_s_refinement_cells.html" title="A lightweight class to tag grid cells containing the level set variable for grid refinement.">TagLSRefinementCells</a> class object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 27 2024 12:22:28 for IBAMR by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>IBAMR: IBTK::FischerGuess Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IBAMR
   </div>
   <div id="projectbrief">An adaptive and distributed-memory parallel implementation of the immersed boundary (IB) method</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_i_b_t_k.html">IBTK</a></li><li class="navelem"><a class="el" href="class_i_b_t_k_1_1_fischer_guess.html">FischerGuess</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="class_i_b_t_k_1_1_fischer_guess-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">IBTK::FischerGuess Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;ibtk/FischerGuess.h&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5458bdaa4c88e0cc6401aaa0f32dc7c0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_b_t_k_1_1_fischer_guess.html#a5458bdaa4c88e0cc6401aaa0f32dc7c0">FischerGuess</a> ()</td></tr>
<tr class="separator:a5458bdaa4c88e0cc6401aaa0f32dc7c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19ff079d9849e95704d949ddc05a0874"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_b_t_k_1_1_fischer_guess.html#a19ff079d9849e95704d949ddc05a0874">FischerGuess</a> (int n_vectors)</td></tr>
<tr class="separator:a19ff079d9849e95704d949ddc05a0874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd10469b9411769966da1534faf1c93a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_b_t_k_1_1_fischer_guess.html#abd10469b9411769966da1534faf1c93a">submit</a> (const libMesh::NumericVector&lt; double &gt; &amp;solution, const libMesh::NumericVector&lt; double &gt; &amp;rhs)</td></tr>
<tr class="separator:abd10469b9411769966da1534faf1c93a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22a4545da47b8e1b5950ba7661607102"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_b_t_k_1_1_fischer_guess.html#a22a4545da47b8e1b5950ba7661607102">guess</a> (libMesh::NumericVector&lt; double &gt; &amp;solution, const libMesh::NumericVector&lt; double &gt; &amp;rhs) const </td></tr>
<tr class="separator:a22a4545da47b8e1b5950ba7661607102"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a935d6865b19ce573293848097148ae1e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a935d6865b19ce573293848097148ae1e"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>d_n_max_vectors</b> = 5</td></tr>
<tr class="separator:a935d6865b19ce573293848097148ae1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e0e64672770eb6244e68f3bfe388b90"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0e0e64672770eb6244e68f3bfe388b90"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>d_n_stored_vectors</b> = 0</td></tr>
<tr class="separator:a0e0e64672770eb6244e68f3bfe388b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7c7d49eac3fc790712992cbaec25ec7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af7c7d49eac3fc790712992cbaec25ec7"></a>
libMesh::DenseMatrix&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>d_correlation_matrix</b></td></tr>
<tr class="separator:af7c7d49eac3fc790712992cbaec25ec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01dc704c2ff74e9b8653690c4ef40c53"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a01dc704c2ff74e9b8653690c4ef40c53"></a>
<a class="elRef" doxygen="/home/travis/build/IBAMR/IBAMR/doc/libstdc++.tag:http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/" href="http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a06912.html">std::vector</a>&lt; <a class="elRef" doxygen="/home/travis/build/IBAMR/IBAMR/doc/libstdc++.tag:http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/" href="http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a06956.html">std::unique_ptr</a>&lt; libMesh::NumericVector&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>d_solutions</b></td></tr>
<tr class="separator:a01dc704c2ff74e9b8653690c4ef40c53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1585b34949e05baca573707f504ec58e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1585b34949e05baca573707f504ec58e"></a>
<a class="elRef" doxygen="/home/travis/build/IBAMR/IBAMR/doc/libstdc++.tag:http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/" href="http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a06912.html">std::vector</a>&lt; <a class="elRef" doxygen="/home/travis/build/IBAMR/IBAMR/doc/libstdc++.tag:http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/" href="http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a06956.html">std::unique_ptr</a>&lt; libMesh::NumericVector&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>d_rhs</b></td></tr>
<tr class="separator:a1585b34949e05baca573707f504ec58e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class implementing a modified version of Fischer's first algorithm from the 1998 manuscript "Projection techniques for iterative solution of A x = b with
successive right-hand sides".</p>
<p>In essence, the caller submits pairs of solution and corresponding RHS vectors from solving the same matrix equation several times (i.e., at different time steps). This class uses those pairs to compute an estimated solution vector for a new RHS. In practice, this estimate is a good enough that it cuts the number of required solver iterations by about 50%, while computing the initial guess is relatively inexpensive.</p>
<p>The algorithm used below varies from the one Fischer proposed in a few major ways: </p><ol>
<li>
The RHS vectors are not orthogonalized. Instead, the least-squares equation is solved with the SVD, which enables the projection matrix to be singular (or nearly so). </li>
<li>
Since this class does not orthogonalize, it can compute the projection matrix incrementally. This means (unlike the PETSc implementation) we can always use the full set of available vectors to compute a guess. </li>
<li>
The projection is done with the standard $R^n$ inner product, which may not be optimal, but is much faster than doing sparse matrix-vector multiplications. </li>
</ol>
<p>Since the systems we solve typically require low iteration counts, these tricks to get a less optimal guess at a lower cost are beneficial. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a5458bdaa4c88e0cc6401aaa0f32dc7c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IBTK::FischerGuess::FischerGuess </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor. Sets the number of stored vectors to five. </p>

</div>
</div>
<a class="anchor" id="a19ff079d9849e95704d949ddc05a0874"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IBTK::FischerGuess::FischerGuess </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_vectors</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n_vectors</td><td>The number of stored vectors. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a22a4545da47b8e1b5950ba7661607102"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IBTK::FischerGuess::guess </td>
          <td>(</td>
          <td class="paramtype">libMesh::NumericVector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const libMesh::NumericVector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a RHS vector, use the stored collection of vectors to compute an estimate of its corresponding solution vector. </p>

</div>
</div>
<a class="anchor" id="abd10469b9411769966da1534faf1c93a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IBTK::FischerGuess::submit </td>
          <td>(</td>
          <td class="paramtype">const libMesh::NumericVector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const libMesh::NumericVector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a new solution and RHS pair to the stored collection. If the collection is full then the oldest vectors are removed. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/travis/build/IBAMR/IBAMR/ibtk/include/ibtk/FischerGuess.h</li>
<li>/home/travis/build/IBAMR/IBAMR/ibtk/src/lagrangian/FischerGuess.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 21 2020 19:38:18 for IBAMR by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>

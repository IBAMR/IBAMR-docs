<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IBAMR: Input and Restart Databases</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IBAMR
   &#160;<span id="projectnumber">IBAMR version 0.19.</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Input and Restart Databases</div>  </div>
</div><!--header-->
<div class="contents">

<p>How <a class="el" href="namespaceIBAMR.html">IBAMR</a> uses databases for setting up objects.  
<a href="#details">More...</a></p>
<h1><a class="anchor" id="autotoc_md27"></a>
Input and Restart Databases in IBAMR</h1>
<h2><a class="anchor" id="autotoc_md28"></a>
Overview</h2>
<p>Most <a class="el" href="namespaceSAMRAI.html">SAMRAI</a> objects (and, hence, most <a class="el" href="namespaceIBAMR.html">IBAMR</a> objects) are constructed with an input database. For example, <code>IBExplicitHierarchyIntegrator</code> has a single constructor with the following arguments:</p>
<div class="fragment"><div class="line">IBExplicitHierarchyIntegrator(std::string object_name,</div>
<div class="line">                              <a class="code" href="classSAMRAI_1_1tbox_1_1Pointer.html">SAMRAI::tbox::Pointer&lt;SAMRAI::tbox::Database&gt;</a> input_db,</div>
<div class="line">                              <a class="code" href="classSAMRAI_1_1tbox_1_1Pointer.html">SAMRAI::tbox::Pointer&lt;IBStrategy&gt;</a> ib_method_ops,</div>
<div class="line">                              <a class="code" href="classSAMRAI_1_1tbox_1_1Pointer.html">SAMRAI::tbox::Pointer&lt;INSHierarchyIntegrator&gt;</a> ins_hier_integrator,</div>
<div class="line">                              <span class="keywordtype">bool</span> register_for_restart = <span class="keyword">true</span>);</div>
</div><!-- fragment --><p>Of these, the second argument configures the object every time it is constructed and the first, second, and last arguments are used when the application is restarted.</p>
<h2><a class="anchor" id="autotoc_md29"></a>
Initial configuration is done with input databases</h2>
<p>Here the second argument is the input database, which contains all the parameters that configure that class. For example, the constructor of this class decides whether or not to use a structure predictor if <code>use_structure_predictor</code> is provided as a boolean to the input database.</p>
<p>These databases are specified in the input file. For example, one would create an <code>IBExplicitHierarchyIntegrator</code> in the following way: </p><div class="fragment"><div class="line">Pointer&lt;IBHierarchyIntegrator&gt; time_integrator =</div>
<div class="line">    <span class="keyword">new</span> IBExplicitHierarchyIntegrator(<span class="stringliteral">&quot;IBHierarchyIntegrator&quot;</span>,</div>
<div class="line">                                      app_initializer-&gt;getComponentDatabase(<span class="stringliteral">&quot;IBHierarchyIntegrator&quot;</span>),</div>
<div class="line">                                      ib_method_ops,</div>
<div class="line">                                      navier_stokes_integrator);</div>
</div><!-- fragment --><p>Here <code>app_initializer-&gt;getComponentDatabase()</code> gets a database from the input file named <code>IBHierarchyIntegrator</code>. This is spelt out in the input file provided to the application. Hence, finally, the input file might contain the following input database: </p><div class="fragment"><div class="line">IBHierarchyIntegrator {</div>
<div class="line">   start_time          = START_TIME</div>
<div class="line">   end_time            = END_TIME</div>
<div class="line">   grow_dt             = GROW_DT</div>
<div class="line">   num_cycles          = NUM_CYCLES</div>
<div class="line">   regrid_cfl_interval = REGRID_CFL_INTERVAL</div>
<div class="line">   dt_max              = DT</div>
<div class="line">   error_on_dt_change  = ERROR_ON_DT_CHANGE</div>
<div class="line">   enable_logging      = ENABLE_LOGGING</div>
<div class="line"> </div>
<div class="line">   use_structure_predictor = FALSE</div>
<div class="line">}</div>
</div><!-- fragment --><p>which will completely configure the <code>IBExplicitHierarchyIntegrator</code> object. Some options here are used by the base class. <a class="el" href="namespaceIBAMR.html">IBAMR</a> uses the convention that constants common to multiple classes are written in all caps and are defined at the top level of the input database.</p>
<h2><a class="anchor" id="autotoc_md30"></a>
Restart configuration is done with a restart database</h2>
<p><a class="el" href="namespaceIBAMR.html">IBAMR</a> applications tend to be very computationally expensive and can require days or weeks to finish. Hence all <a class="el" href="namespaceIBAMR.html">IBAMR</a> objects can store their current state to a file so that the computation can be stopped and started several times.</p>
<p>Many objects store state that changes over the duration of a computation (such as the current time, the center of mass of a structure, or a velocity field): the state of the object at any point in time can be saved to an output file with the <code>putToDatabase()</code> and <code>putToDatabaseSpecialized()</code> methods. <a class="el" href="namespaceSAMRAI.html">SAMRAI</a> associates objects with the restart database with their object names (which is typically the first argument to the constructor): i.e., data is saved or loaded from a part of the restart file which is identified by the object name. Objects don't have to be registered with the restart database: in the case of <code>IBExplicitHierarchyIntegrator</code> the last argument to the constructor is a boolean indicating whether or not the object should be placed in the restart database.</p>
<p><a class="el" href="namespaceIBAMR.html">IBAMR</a> uses <a class="el" href="namespaceSAMRAI.html">SAMRAI</a>'s <code>RestartManager</code> to store information for restarting a computation. Hence, most <a class="el" href="namespaceIBAMR.html">IBAMR</a> object constructors contain the following code after the input database is read in:</p>
<div class="fragment"><div class="line"><span class="comment">// Initialize object with data read from the input and restart databases.</span></div>
<div class="line"><span class="keywordtype">bool</span> from_restart = RestartManager::getManager()-&gt;isFromRestart();</div>
<div class="line"><span class="keywordflow">if</span> (from_restart) getFromRestart();</div>
</div><!-- fragment --><p>Hence, object initialization is done in several stages:</p><ol type="1">
<li>Set up everything provided by the constructor that is not in the input database.</li>
<li>Set up everything provided by the input database.</li>
<li>If the current application is a restart (i.e., there is something in the restart database), then read the current state of the object from the restart file.</li>
</ol>
<p>Similarly, an object should save the information that describes its current state (not its initial configuration) into the restart database, since the same input file will always be used for the initial configuration of the object. </p>
</div><!-- contents -->
<div class="ttc" id="aclassSAMRAI_1_1tbox_1_1Pointer_html"><div class="ttname"><a href="classSAMRAI_1_1tbox_1_1Pointer.html">SAMRAI::tbox::Pointer&lt; SAMRAI::tbox::Database &gt;</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>

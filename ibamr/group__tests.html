<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IBAMR: Test Runner</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IBAMR
   &#160;<span id="projectnumber">IBAMR version 0.19.</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Test Runner</div>  </div>
</div><!--header-->
<div class="contents">

<p>Description of <a class="el" href="namespaceIBAMR.html">IBAMR</a>'s test runner, attest.  
<a href="#details">More...</a></p>
<h1><a class="anchor" id="autotoc_md46"></a>
Using &lt;tt&gt;attest&lt;/tt&gt;, IBAMR's test suite runner</h1>
<h2><a class="anchor" id="autotoc_md47"></a>
Introduction</h2>
<p><a class="el" href="namespaceIBAMR.html">IBAMR</a> includes a test suite consisting of both unit tests (tests of individual functionality implemented in <a class="el" href="namespaceIBAMR.html">IBAMR</a>) and integration tests (tests of codes written using <a class="el" href="namespaceIBAMR.html">IBAMR</a>). These tests range from simply printing some output on an 8x8 grid to running a three-dimensional problem with MPI. The goal is to ultimately implement unit or integration tests for all features in <a class="el" href="namespaceIBAMR.html">IBAMR</a>.</p>
<h2><a class="anchor" id="autotoc_md48"></a>
Design Goals</h2>
<p>The goal of the test suite is to design a system that lets <a class="el" href="namespaceIBAMR.html">IBAMR</a> developers easily write unit tests for small pieces of functionality. The tests should be compiled by the build system like other example programs. The test runner should be completely separate from the build system and should be able to run tests in parallel and, when requested, use multiple MPI processes for each test.</p>
<h2><a class="anchor" id="autotoc_md49"></a>
Requirements</h2>
<p>The test runner, <code>attest</code>, requires Python 3.5 or newer and numdiff. The location of the numdiff installation is provided to cmake via <code>-DNUMDIFF_ROOT</code>. CMake extracts the paths to the numdiff and mpi executables as well as some other basic parameters to populate <code>attest.conf</code>, which usually depends on the current build environment.</p>
<p>Tests are compiled via the <code>tests</code> target (e.g., via <code>make -j4 tests</code>).</p>
<h2><a class="anchor" id="autotoc_md50"></a>
Files</h2>
<p>The test suite consists of three components:</p>
<ol type="1">
<li>Test executables: these are executables compiled and linked against <a class="el" href="namespaceIBAMR.html">IBAMR</a> by the build system. They are implemented in nearly the same way as the example programs. All source files for the test executables are located in subdirectories of <code>tests/</code> in the top directory.</li>
<li>The test input and output files: <a class="el" href="namespaceIBAMR.html">IBAMR</a>'s test suite assumes that each test corresponds to exactly one pair of input and output files. The file names for the input and output file starts with the name of the required test executable followed by a period, with additional data separated by periods. For example: the test executable <code>interpolate_velocity_01</code> is used in multiple tests since there are several input and output files starting with <code>interpolate_velocity_01</code> (though each has different text after the period). The number of MPI processes is encoded into the test input and output files by writing, e.g., `<code>.mpirun=42.</code> in the filename. The build system will create symbolic links to these files inside the build directory.</li>
<li>The test runner: this is the python script <code>attest</code> in the top-level directory. The build system creates a symbolic link to this script and generates a configuration file, <code>attest.conf</code>, inside the build directory.</li>
</ol>
<h2><a class="anchor" id="autotoc_md51"></a>
attest</h2>
<p>The program that finds and executes tests is the test runner: <code>attest</code>. <code>attest</code> is very similar, aside from being decoupled from the build system, to <code>ctest</code>, and supports many of the same options. All options can be displayed by running <code>./attest --help</code>: a few common options include</p>
<ol type="1">
<li><code>-j,--jobs N Running attest -j4</code> or <code>attest --jobs 4</code> will run four job processes at once. This could be one test with 4 MPI processes, two tests each using two MPI processes, etc.</li>
<li><code>-R,--tests-regex TEST_REGEX</code> Running <code>attest -R interp</code> will filter the tests and only run the tests with <code>interp</code> in their names.</li>
<li><code>-N,--show-only</code> Running <code>attest -N</code> will disable the actual execution of tests, but will print the names of all tests that would have been run.</li>
</ol>
<p>Since the build system compiles the executables and links input and output files into the build directory, <code>attest</code> simply looks for tests in the <code>tests/</code> directory in which it is run. Hence, running </p><pre class="fragment">  make -j8 tests
  ./attest -j8
</pre><p>from the top build directory will compile and run the whole test suite while using eight processors. </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>

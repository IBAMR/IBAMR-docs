<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IBAMR: IBTK::FischerGuess Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IBAMR
   &#160;<span id="projectnumber">IBAMR version 0.19.</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceIBTK.html">IBTK</a></li><li class="navelem"><a class="el" href="classIBTK_1_1FischerGuess.html">FischerGuess</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classIBTK_1_1FischerGuess-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">IBTK::FischerGuess Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;ibtk/FischerGuess.h&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5458bdaa4c88e0cc6401aaa0f32dc7c0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIBTK_1_1FischerGuess.html#a5458bdaa4c88e0cc6401aaa0f32dc7c0">FischerGuess</a> ()</td></tr>
<tr class="separator:a5458bdaa4c88e0cc6401aaa0f32dc7c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19ff079d9849e95704d949ddc05a0874"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIBTK_1_1FischerGuess.html#a19ff079d9849e95704d949ddc05a0874">FischerGuess</a> (<a class="el" href="classint.html">int</a> n_vectors)</td></tr>
<tr class="separator:a19ff079d9849e95704d949ddc05a0874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd10469b9411769966da1534faf1c93a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIBTK_1_1FischerGuess.html#abd10469b9411769966da1534faf1c93a">submit</a> (const <a class="el" href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a>&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;solution, const <a class="el" href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a>&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;rhs)</td></tr>
<tr class="separator:abd10469b9411769966da1534faf1c93a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0231a70fc1bc9ec9c7fb41672e5a58e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIBTK_1_1FischerGuess.html#ad0231a70fc1bc9ec9c7fb41672e5a58e">guess</a> (<a class="el" href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a>&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;solution, const <a class="el" href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a>&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;rhs) const</td></tr>
<tr class="separator:ad0231a70fc1bc9ec9c7fb41672e5a58e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a935d6865b19ce573293848097148ae1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIBTK_1_1FischerGuess.html#a935d6865b19ce573293848097148ae1e">d_n_max_vectors</a> = 5</td></tr>
<tr class="separator:a935d6865b19ce573293848097148ae1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e0e64672770eb6244e68f3bfe388b90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIBTK_1_1FischerGuess.html#a0e0e64672770eb6244e68f3bfe388b90">d_n_stored_vectors</a> = 0</td></tr>
<tr class="separator:a0e0e64672770eb6244e68f3bfe388b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e228f432e783e974df0c496662a5acd"><td class="memItemLeft" align="right" valign="top">Eigen::Matrix&lt; <a class="el" href="classdouble.html">double</a>, Eigen::Dynamic, Eigen::Dynamic &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIBTK_1_1FischerGuess.html#a0e228f432e783e974df0c496662a5acd">d_correlation_matrix</a></td></tr>
<tr class="separator:a0e228f432e783e974df0c496662a5acd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01dc704c2ff74e9b8653690c4ef40c53"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a>&lt; <a class="el" href="classdouble.html">double</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIBTK_1_1FischerGuess.html#a01dc704c2ff74e9b8653690c4ef40c53">d_solutions</a></td></tr>
<tr class="separator:a01dc704c2ff74e9b8653690c4ef40c53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1585b34949e05baca573707f504ec58e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a>&lt; <a class="el" href="classdouble.html">double</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIBTK_1_1FischerGuess.html#a1585b34949e05baca573707f504ec58e">d_rhs</a></td></tr>
<tr class="separator:a1585b34949e05baca573707f504ec58e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class implementing a modified version of Fischer's first algorithm from the 1998 manuscript "Projection techniques for iterative solution of A x = b with
successive right-hand sides".</p>
<p>In essence, the caller submits pairs of solution and corresponding RHS vectors from solving the same matrix equation several times (i.e., at different time steps). This class uses those pairs to compute an estimated solution vector for a new RHS. In practice, this estimate is a good enough that it cuts the number of required solver iterations by about 50%, while computing the initial guess is relatively inexpensive.</p>
<p>The algorithm used below varies from the one Fischer proposed in a few major ways: </p><ol>
<li>
The RHS vectors are not orthogonalized. Instead, the least-squares equation is solved with the SVD, which enables the projection matrix to be singular (or nearly so). </li>
<li>
Since this class does not orthogonalize, it can compute the projection matrix incrementally. This means (unlike the PETSc implementation) we can always use the full set of available vectors to compute a guess. </li>
<li>
The projection is done with the standard $R^n$ inner product, which may not be optimal, but is much faster than doing sparse matrix-vector multiplications. </li>
</ol>
<p>Since the systems we solve typically require low iteration counts, these tricks to get a less optimal guess at a lower cost are beneficial. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5458bdaa4c88e0cc6401aaa0f32dc7c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5458bdaa4c88e0cc6401aaa0f32dc7c0">&#9670;&nbsp;</a></span>FischerGuess() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IBTK::FischerGuess::FischerGuess </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor. Sets the number of stored vectors to five. </p>

</div>
</div>
<a id="a19ff079d9849e95704d949ddc05a0874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19ff079d9849e95704d949ddc05a0874">&#9670;&nbsp;</a></span>FischerGuess() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IBTK::FischerGuess::FischerGuess </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>n_vectors</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n_vectors</td><td>The number of stored vectors. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abd10469b9411769966da1534faf1c93a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd10469b9411769966da1534faf1c93a">&#9670;&nbsp;</a></span>submit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IBTK::FischerGuess::submit </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a>&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a>&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a new solution and RHS pair to the stored collection. If the collection is full then the oldest vectors are removed. </p>

</div>
</div>
<a id="ad0231a70fc1bc9ec9c7fb41672e5a58e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0231a70fc1bc9ec9c7fb41672e5a58e">&#9670;&nbsp;</a></span>guess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IBTK::FischerGuess::guess </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a>&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a>&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a RHS vector, use the stored collection of vectors to compute an estimate of its corresponding solution vector. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a935d6865b19ce573293848097148ae1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a935d6865b19ce573293848097148ae1e">&#9670;&nbsp;</a></span>d_n_max_vectors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> IBTK::FischerGuess::d_n_max_vectors = 5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0e0e64672770eb6244e68f3bfe388b90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e0e64672770eb6244e68f3bfe388b90">&#9670;&nbsp;</a></span>d_n_stored_vectors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> IBTK::FischerGuess::d_n_stored_vectors = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0e228f432e783e974df0c496662a5acd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e228f432e783e974df0c496662a5acd">&#9670;&nbsp;</a></span>d_correlation_matrix</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::Matrix&lt;<a class="el" href="classdouble.html">double</a>, Eigen::Dynamic, Eigen::Dynamic&gt; IBTK::FischerGuess::d_correlation_matrix</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a01dc704c2ff74e9b8653690c4ef40c53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01dc704c2ff74e9b8653690c4ef40c53">&#9670;&nbsp;</a></span>d_solutions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a>&lt;<a class="el" href="classdouble.html">double</a>&gt; &gt; &gt; IBTK::FischerGuess::d_solutions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1585b34949e05baca573707f504ec58e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1585b34949e05baca573707f504ec58e">&#9670;&nbsp;</a></span>d_rhs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a>&lt;<a class="el" href="classdouble.html">double</a>&gt; &gt; &gt; IBTK::FischerGuess::d_rhs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>ibtk/include/ibtk/<a class="el" href="FischerGuess_8h.html">FischerGuess.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
